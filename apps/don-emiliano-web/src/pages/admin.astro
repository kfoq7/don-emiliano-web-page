---
import LayoutAdmin from '@/layouts/LayoutAdmin.astro'
import type { Product } from '@/types/Product'
// import { isAdmin } from '@/utils/admin'

// if (!Astro.locals.user) {
//   return Astro.redirect('/404')
// }

// const userId = Astro.locals.user.id
// if (!isAdmin(`${userId}`)) {
//   return Astro.redirect('/404')
// }

const API_URL = import.meta.env.PUBLIC_API_URL

const response = await fetch(`${API_URL}/products`, { method: 'GET' })
const data = (await response.json()) as Product[]
---

<LayoutAdmin>
  {
    data.map(({ id, name, description, price }) => (
      <div>
        {id} {name} {description} {price}
      </div>
    ))
  }
</LayoutAdmin>
